<mat-card>
  <mat-card-header class="section-container">
    <mat-card-title>Filter by...</mat-card-title>
    <button
      [disabled]="(hasAppliedFilters$ | async) === false"
      mat-button
      class="clear-button"
      color="primary"
      (click)="clearFacets()"
    >
      <mat-icon>clear_all</mat-icon> Clear
    </button>
    <button
      mat-button
      class="settings-button"
      (click)="toggleEditMode()"
    >
      <mat-icon>settings</mat-icon>
    </button>
  </mat-card-header>

  <mat-card-content>
      <div style="display: flex; align-items: center;" *ngIf="selectedFilters[PidFilterComponent.kName]">
      <app-pid-filter
        [clear]="clearSearchBar"
        style="flex-grow: 1;"
      >
      </app-pid-filter>
      <button
        *ngIf="isInEditMode"
        mat-button
        (click)="removeFilter(PidFilterComponent.kName)"
      >
        <mat-icon>delete</mat-icon>
      </button>
      </div>

    <div style="display: flex; align-items: center;" *ngIf="selectedFilters[LocationFilterComponent.kName]">
      <app-location-filter
        [clear]="clearSearchBar"
        style="flex-grow: 1;"
      >
      </app-location-filter>
      <button
        *ngIf="isInEditMode"
        mat-button
        (click)="removeFilter(LocationFilterComponent.kName)"
      >
        <mat-icon>delete</mat-icon>
      </button>
    </div>

    <div style="display: flex; align-items: center;" *ngIf="selectedFilters[GroupFilterComponent.kName]">
      <app-group-filter
        [clear]="clearSearchBar"
        style="flex-grow: 1;"
      >
      </app-group-filter>
      <button
        *ngIf="isInEditMode"
        mat-button
        (click)="removeFilter(GroupFilterComponent.kName)"
      >
        <mat-icon>delete</mat-icon>
      </button>
    </div>

    <div style="display: flex; align-items: center;" *ngIf="selectedFilters[TypeFilterComponent.kName]">
      <app-type-filter
        [clear]="clearSearchBar"
        style="flex-grow: 1;"
      >
      </app-type-filter>
      <button
        *ngIf="isInEditMode"
        mat-button
        (click)="removeFilter(TypeFilterComponent.kName)"
      >
        <mat-icon>delete</mat-icon>
      </button>
    </div>

      <!--




         <mat-form-field>
           <mat-label>Keywords</mat-label>
           <mat-chip-grid #keywordChipList>
             <mat-chip-row
               *ngFor="let keyword of keywordsFilter$ | async"
               [removable]="true"
               (removed)="keywordRemoved(keyword)"
               >{{ keyword }}<mat-icon matChipRemove>cancel</mat-icon>
             </mat-chip-row>
           </mat-chip-grid>
           <input
             (input)="onKeywordInput($event)"
             [value]="keywordsInput$ | async"
             matInput
             class="keyword-input"
             [matChipInputFor]="keywordChipList"
             [matAutocomplete]="kw"
           />
           <mat-autocomplete #kw="matAutocomplete">
             <mat-option
               (onSelectionChange)="keywordSelected(getFacetId(fc))"
               *ngFor="let fc of keywordsSuggestions$ | async"
             >
               <span>{{ getFacetId(fc, "No Keywords") }}</span>
               <small>: {{ getFacetCount(fc) }}</small>
             </mat-option>
           </mat-autocomplete>
         </mat-form-field>

         <mat-form-field>
           <mat-label>Start Date - End Date</mat-label>
           <mat-date-range-input class="date-input" [rangePicker]="picker">
             <input
               matStartDate
               name="begin"
               [value]="(creationTimeFilter$ | async)?.begin"
               (dateChange)="dateChanged($event)"
             />
             <input
               matEndDate
               name="end"
               [value]="(creationTimeFilter$ | async)?.end"
               (dateChange)="dateChanged($event)"
             />
           </mat-date-range-input>
           <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
           <mat-date-range-picker #picker></mat-date-range-picker>
         </mat-form-field>-->

    <div class="section-container" *ngIf="appConfig.scienceSearchEnabled && isInEditMode">
      <button mat-button color="primary" (click)="showAddConditionDialog()">
        <mat-icon>add</mat-icon> Add Condition
      </button>

      <mat-chip-listbox class="scientific-chips" aria-orientation="vertical">
        <mat-chip-option
          class="scientific-chip"
          *ngFor="let condition of scientificConditions$ | async; index as i"
        >
          <span class="scientific-chip-text">
            {{ condition.lhs }}
            <ng-container [ngSwitch]="condition.relation">
              <ng-container *ngSwitchCase="'EQUAL_TO_NUMERIC'">
                &nbsp;=&nbsp;
              </ng-container>
              <ng-container *ngSwitchCase="'EQUAL_TO_STRING'">
                &nbsp;=&nbsp;
              </ng-container>
              <ng-container *ngSwitchCase="'LESS_THAN'">
                &nbsp;&lt;&nbsp;
              </ng-container>
              <ng-container *ngSwitchCase="'GREATER_THAN'">
                &nbsp;&gt;&nbsp;
              </ng-container>
            </ng-container>
            {{
              condition.relation === "EQUAL_TO_STRING"
                ? '"' + condition.rhs + '"'
                : condition.rhs
            }}
            {{ condition.unit | prettyUnit }}
          </span>
          <mat-icon matChipRemove (click)="removeCondition(condition, i)"
            >cancel</mat-icon
          >
        </mat-chip-option>
      </mat-chip-listbox>
    </div>

    <div  class="section-container" *ngIf="isInEditMode">
    <button mat-button color="primary" [matMenuTriggerFor]="addFilterMenu">
      <mat-icon>add</mat-icon>
      Add Filter
    </button>
    <mat-menu #addFilterMenu="matMenu">
      <button mat-menu-item (click)="addFilter(PidFilterComponent.kName)">PID Filter</button>
      <button mat-menu-item (click)="addFilter(LocationFilterComponent.kName)">Location Filter</button>
      <button mat-menu-item (click)="addFilter(GroupFilterComponent.kName)">Group Filter</button>
      <button mat-menu-item (click)="addFilter(TypeFilterComponent.kName)">Type Filter</button>
      <!-- Add more filter types here -->
    </mat-menu>
    </div>

    <div class="section-container">
      <button mat-raised-button color="primary" class="applyButton" (click)="applyFilters()">
        Apply
      </button>
    </div>
  </mat-card-content>
</mat-card>
